# Apollo

한줄요약: GraphQL기반 라이브러리... 아직 정확하지 않음.

아폴로 클라이언트와 그래프큐엘 조합이 어떻게 리덕스를 대체하는가?

## 1. Redux + RESTful API 문제점
1. 데이터 fetching이 포함된 컴포넌트 렌더링(즉, 서버에서 뭔가 가져와서 뿌려줘야할 때)을 할 때 리덕스는 너무 많은 과정을 거친다.
2. 언더페칭, 오버페칭, 수많은 엔드포인트

## 2. 아폴로 클라이언트 + 그래프큐엘을 사용한 렌더링
### 아폴로를 이용한 렌더링방법
1. 쿼리를 GraphQL 문법으로 짠다.
2. react-apollo의 Query 컴포넌트로 해당 쿼리문을 넣어 컴포넌트로 쓴다.
3. 실제 데이터를 가져오는 동작은 HOC(higher-order component)를 통해 진행한다. 즉 페칭과 라이프사이클을 고민할 필요가 없다.
### 아폴로를 통해 데이터를 가져오는 과정

1. `<Query/>` 컴포넌트가 마운트되면 Apollo Client는 요청할 데이터 값을 정의해 놓은 query에 대한 옵서버를 생성한다.
2. 컴포넌트는 Apollo Client 캐시를 통해 query에 대한 결괏값을 구독한다.
3. 이후 우선적으로 query 결괏값을 Apollo Client 캐시에서 탐색한다.
4. 저장된 캐시가 없으면 서버로 요청을 보낸다. 서버에서 데이터를 받으면 Apollo Client 캐시에 저장한다.
5. `<Query/>` 컴포넌트가 결괏값을 구독하고 있기 때문에 자동으로 업데이트된다.

즉, 데이터 페칭을 담당하는 최상위 오브젝트 하나를 둔 것이다.
